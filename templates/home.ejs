<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/head', { title: 'Financialytics'}) %>
    <script src="/home.js" defer></script>
</head>
<body data-user="<%=user%>">
<main id="home">
    <header class="division">
        <h1>Financialytics</h1>
    </header>
    <section id="summary" class="division">
        <a id="charts" href="/charts"><h2>Spending Summary - <%=month%></h2></a>
        <div id="chart">
            <img src="<%=chart%>" alt="Spending Summary">
        </div>
    </section>
    <section id="recent" class="division">
        <a id="history" href="/history?uid=<%=user.id%>"><h2>Recent Transactions</h2></a>
        <table id="transactions">
            <% for (const transaction of transactions.reverse()) { %> 
                <tr>
                    <%- include('partials/transaction', { transaction }) %>
                </tr>
            <% } %>
        </table>
    </section>
</main>
<section id="sidebar" class="division">
    <h2>Goals</h2>
    <div id="income">
        <h3>Income</h3>
        <% const income = transactions.filter(transaction => transaction.category === 'income').reduce((acc, transaction) => acc + transaction.amount, 0) / 100 %>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBarIncome"></div>
        </div>
        <div class="values">
            <span id="incomeCurrent" data-income="<%=income%>">$0</span>
            <span id="incomeBudget" data-budget="500">$0</span>
        </div>
    </div>
</section>
</body>
</html>